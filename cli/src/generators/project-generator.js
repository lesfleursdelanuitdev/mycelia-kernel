/**
 * Project Generator
 * Generates project-level files (bootstrap, package.json, .gitignore)
 */

export function generateBootstrapFile(projectName) {
  return `/**
 * Bootstrap file for ${projectName}
 * Generated by mycelia-kernel CLI
 */

import { MessageSystem } from './mycelia-kernel-v2/models/message-system/message-system.v2.mycelia.js';

/**
 * Bootstrap the Mycelia Kernel application
 */
async function bootstrap() {
  // Create message system
  const messageSystem = new MessageSystem('${projectName}', {
    debug: true
  });

  // Bootstrap kernel
  await messageSystem.bootstrap();

  // TODO: Register custom subsystems
  // const mySubsystem = new MySubsystem('my-subsystem', { ms: messageSystem });
  // await messageSystem.registerSubsystem(mySubsystem);

  return messageSystem;
}

// Export for use
export default bootstrap;

// If running directly
if (import.meta.url === \`file://\${process.argv[1]}\`) {
  bootstrap()
    .then(ms => {
      console.log('Mycelia Kernel bootstrapped successfully');
      return ms;
    })
    .catch(err => {
      console.error('Bootstrap failed:', err);
      process.exit(1);
    });
}
`;
}

export function generatePackageJson(projectName) {
  return JSON.stringify({
    name: toKebabCase(projectName),
    version: '1.0.0',
    type: 'module',
    scripts: {
      bootstrap: 'node bootstrap.mycelia.js'
    },
    dependencies: {},
    devDependencies: {}
  }, null, 2);
}

export function generateGitignore() {
  return `# Dependencies
node_modules/

# Build outputs
dist/
build/

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Logs
*.log
npm-debug.log*

# Environment
.env
.env.local

# Mycelia Kernel
.mycelia-kernel
`;
}

function toKebabCase(str) {
  return str
    .replace(/([a-z])([A-Z])/g, '$1-$2')
    .replace(/[\s_]+/g, '-')
    .toLowerCase();
}



